#Script to run https://cran.r-project.org/web/packages/imputeREE/index.html
#Created: 1-Aug-24, Marco Acevedo
#Updated:
#Note 1: Ho, Tm, Tb were fabricated values to debug imputeREE. They must be excluded
#Note 2: Samples with less than 3 or less elements to model,
#consider filtering that data, or including more elements do not produce a model
#Note 3: Gd, Er, Y cannot be missing values at the same time. Equidistance condition.
##
#install.packages("magrittr")
#install.packages("devtools")
#install.packages("beepr")
library(magrittr)
library(imputeREE)
library(beepr)
library(dplyr)
sourceDir = 'E:/Feb-March_2024_zircon imaging/05_zircon geochemical data/processed_files'
destDir = sourceDir
#\\ also allowed
file1 = 'imputation_input.csv'
file2 = 'imputation_output.csv'
filepath1 = file.path(sourceDir, file1)
filepath2 = file.path(destDir, file2)
input_table <- read.csv(filepath1)
head(input_table, n=10)
columnNames = colnames(input_table)
columnNames2 = columnNames[4:length(columnNames)]
#medicine 1
df["Ho"][df["Ho"] == 0.1] <- NaN
input_table["Ho"][input_table["Ho"] == 0.1] <- NaN
head(input_table, n=10)
input_table["Ho"][input_table["Ho"] == 0.1] <- NaN
input_table["Tm"][input_table["Tm"] == 0.1] <- NaN
input_table["Tb"][input_table["Tb"] == 0.1] <- NaN
output_table <- input_table %>%
#dplyr::slice(1:100) %>%
model_REE(prefix = NULL, suffix = NULL,
method = 3,
exclude = c("La", "Pr", "Ce", "Eu", "Y", "Ho", "Tm", "Tb"),
Calibrate = T) %>%
impute_REE(prefix = NULL, suffix = NULL)
head(output_table, n=10)
#Script to run https://cran.r-project.org/web/packages/imputeREE/index.html
#Created: 1-Aug-24, Marco Acevedo
#Updated:
#Note 1: Ho, Tm, Tb were fabricated values to debug imputeREE. They must be excluded
#Note 2: Samples with less than 3 or less elements to model,
#consider filtering that data, or including more elements do not produce a model
#Note 3: Gd, Er, Y cannot be missing values at the same time. Equidistance condition.
##
#install.packages("magrittr")
#install.packages("devtools")
#install.packages("beepr")
library(magrittr)
library(imputeREE)
library(beepr)
library(dplyr)
sourceDir = 'E:/Feb-March_2024_zircon imaging/05_zircon geochemical data/processed_files'
destDir = sourceDir
#\\ also allowed
file1 = 'imputation_input.csv'
file2 = 'imputation_output.csv'
filepath1 = file.path(sourceDir, file1)
filepath2 = file.path(destDir, file2)
input_table <- read.csv(filepath1)
head(input_table, n=10)
columnNames = colnames(input_table)
columnNames2 = columnNames[4:length(columnNames)]
#medicine 1
input_table["Ho"][input_table["Ho"] == 0.1] <- NaN
input_table["Tm"][input_table["Tm"] == 0.1] <- NaN
input_table["Tb"][input_table["Tb"] == 0.1] <- NaN
output_table <- input_table %>%
#dplyr::slice(1:100) %>%
model_REE(prefix = NULL, suffix = NULL,
method = 3,
exclude = c("La", "Pr", "Ce", "Eu", "Y", "Ho", "Tm", "Tb"),
chondrite = PalmeOneill2014CI, #Oneill2014Mantle, McDonough1995CI
Calibrate = T) %>%
impute_REE(prefix = NULL, suffix = NULL)
#Script to run https://cran.r-project.org/web/packages/imputeREE/index.html
#Created: 1-Aug-24, Marco Acevedo
#Updated:
#Note 1: Ho, Tm, Tb were fabricated values to debug imputeREE. They must be excluded
#Note 2: Samples with less than 3 or less elements to model,
#consider filtering that data, or including more elements do not produce a model
#Note 3: Gd, Er, Y cannot be missing values at the same time. Equidistance condition.
##
#install.packages("magrittr")
#install.packages("devtools")
#install.packages("beepr")
library(magrittr)
library(imputeREE)
library(beepr)
library(dplyr)
sourceDir = 'E:/Feb-March_2024_zircon imaging/05_zircon geochemical data/processed_files'
destDir = sourceDir
#\\ also allowed
file1 = 'imputation_input.csv'
file2 = 'imputation_output_John.csv'
filepath1 = file.path(sourceDir, file1)
filepath2 = file.path(destDir, file2)
input_table <- read.csv(filepath1)
head(input_table, n=10)
columnNames = colnames(input_table)
columnNames2 = columnNames[4:length(columnNames)]
#medicine 1
input_table["Ho"][input_table["Ho"] == 0.1] <- NaN
input_table["Tm"][input_table["Tm"] == 0.1] <- NaN
input_table["Tb"][input_table["Tb"] == 0.1] <- NaN
output_table <- input_table %>%
#dplyr::slice(1:100) %>%
model_REE(prefix = NULL, suffix = NULL,
method = 3,
exclude = c("La", "Pr", "Ce", "Eu", "Y", "Ho", "Tm", "Tb"),
chondrite = PalmeOneill2014CI, #Oneill2014Mantle, McDonough1995CI
Calibrate = T) %>%
impute_REE(prefix = NULL, suffix = NULL)
#model_REE
#method=1 for Chondrite Lattice, 2 for Zhong et al. (2019), or 3 for Chondrite-Onuma method.
#Calibrate= If True, the model is calibrated using the correction factors
#exclude= La, Ce and Eu are the default elements omitted from modelling (not prediction).
#impute_REE
#r-squared = Tolerance to misfitting models. set as 0.9 by default.
#The Chondrite-Lattice method should consider R-squared > 0.95 for at least 3 points.
#The Chondrite-Onuma method should consider R-squared >0.98 for at least 4 points.
head(output_table, n=10)
output_table2 <- output_table
##optional: medicine 2 (redundant and fake elements removed)
#columnNames3 <- append(columnNames2, c("Imputed_Tb","Imputed_Ho",	"Imputed_Tm"))
#output_table2 <- output_table %>% select(-one_of(columnNames3))
write.table(output_table2, file = filepath2, sep = ",", col.names=TRUE, row.names = FALSE)
#col.names = NA to avoid empty rowid
beep()
#Script to run https://cran.r-project.org/web/packages/imputeREE/index.html
#Created: 1-Aug-24, Marco Acevedo
#Updated:
#Note 1: Ho, Tm, Tb were fabricated values to debug imputeREE. They must be excluded
#Note 2: Samples with less than 3 or less elements to model,
#consider filtering that data, or including more elements do not produce a model
#Note 3: Gd, Er, Y cannot be missing values at the same time. Equidistance condition.
##
#install.packages("magrittr")
#install.packages("devtools")
#install.packages("beepr")
library(magrittr)
library(imputeREE)
library(beepr)
library(dplyr)
sourceDir = 'E:/Feb-March_2024_zircon imaging/05_zircon geochemical data/processed_files'
destDir = sourceDir
#\\ also allowed
file1 = 'imputation_input.csv'
file2 = 'imputation_output_Chondrite Lattice.csv'
filepath1 = file.path(sourceDir, file1)
filepath2 = file.path(destDir, file2)
input_table <- read.csv(filepath1)
head(input_table, n=10)
columnNames = colnames(input_table)
columnNames2 = columnNames[4:length(columnNames)]
#medicine 1
input_table["Ho"][input_table["Ho"] == 0.1] <- NaN
input_table["Tm"][input_table["Tm"] == 0.1] <- NaN
input_table["Tb"][input_table["Tb"] == 0.1] <- NaN
output_table <- input_table %>%
#dplyr::slice(1:100) %>%
model_REE(prefix = NULL, suffix = NULL,
method = 3,
exclude = c("La", "Pr", "Ce", "Eu", "Y", "Ho", "Tm", "Tb"),
chondrite = PalmeOneill2014CI, #Oneill2014Mantle, McDonough1995CI
Calibrate = T) %>%
impute_REE(prefix = NULL, suffix = NULL, rsquared = 0.98)
#model_REE
#method=1 for Chondrite Lattice, 2 for Zhong et al. (2019), or 3 for Chondrite-Onuma method.
#Calibrate= If True, the model is calibrated using the correction factors
#exclude= La, Ce and Eu are the default elements omitted from modelling (not prediction).
#impute_REE
#r-squared = Tolerance to misfitting models. set as 0.9 by default.
#The Chondrite-Lattice method should consider R-squared > 0.95 for at least 3 points.
#The Chondrite-Onuma method should consider R-squared >0.98 for at least 4 points.
head(output_table, n=10)
output_table2 <- output_table
##optional: medicine 2 (redundant and fake elements removed)
#columnNames3 <- append(columnNames2, c("Imputed_Tb","Imputed_Ho",	"Imputed_Tm"))
#output_table2 <- output_table %>% select(-one_of(columnNames3))
write.table(output_table2, file = filepath2, sep = ",", col.names=TRUE, row.names = FALSE)
#col.names = NA to avoid empty rowid
beep()
#Script to run https://cran.r-project.org/web/packages/imputeREE/index.html
#Created: 1-Aug-24, Marco Acevedo
#Updated:
#Note 1: Ho, Tm, Tb were fabricated values to debug imputeREE. They must be excluded
#Note 2: Samples with less than 3 or less elements to model,
#consider filtering that data, or including more elements do not produce a model
#Note 3: Gd, Er, Y cannot be missing values at the same time. Equidistance condition.
##
#install.packages("magrittr")
#install.packages("devtools")
#install.packages("beepr")
library(magrittr)
library(imputeREE)
library(beepr)
library(dplyr)
sourceDir = 'E:/Feb-March_2024_zircon imaging/05_zircon geochemical data/processed_files'
destDir = sourceDir
#\\ also allowed
file1 = 'imputation_input.csv'
file2 = 'imputation_output_Chondrite Lattice.csv'
filepath1 = file.path(sourceDir, file1)
filepath2 = file.path(destDir, file2)
input_table <- read.csv(filepath1)
head(input_table, n=10)
columnNames = colnames(input_table)
columnNames2 = columnNames[4:length(columnNames)]
#medicine 1
input_table["Ho"][input_table["Ho"] == 0.1] <- NaN
input_table["Tm"][input_table["Tm"] == 0.1] <- NaN
input_table["Tb"][input_table["Tb"] == 0.1] <- NaN
output_table <- input_table %>%
#dplyr::slice(1:100) %>%
model_REE(prefix = NULL, suffix = NULL,
method = 1,
exclude = c("La", "Pr", "Ce", "Eu", "Y", "Ho", "Tm", "Tb"),
chondrite = PalmeOneill2014CI, #Oneill2014Mantle, McDonough1995CI
Calibrate = T) %>%
impute_REE(prefix = NULL, suffix = NULL, rsquared = 0.98)
#model_REE
#method=1 for Chondrite Lattice, 2 for Zhong et al. (2019), or 3 for Chondrite-Onuma method.
#Calibrate= If True, the model is calibrated using the correction factors
#exclude= La, Ce and Eu are the default elements omitted from modelling (not prediction).
#impute_REE
#r-squared = Tolerance to misfitting models. set as 0.9 by default.
#The Chondrite-Lattice method should consider R-squared > 0.95 for at least 3 points.
#The Chondrite-Onuma method should consider R-squared >0.98 for at least 4 points.
head(output_table, n=10)
output_table2 <- output_table
##optional: medicine 2 (redundant and fake elements removed)
#columnNames3 <- append(columnNames2, c("Imputed_Tb","Imputed_Ho",	"Imputed_Tm"))
#output_table2 <- output_table %>% select(-one_of(columnNames3))
write.table(output_table2, file = filepath2, sep = ",", col.names=TRUE, row.names = FALSE)
#col.names = NA to avoid empty rowid
beep()
#Script to run https://cran.r-project.org/web/packages/imputeREE/index.html
#Created: 1-Aug-24, Marco Acevedo
#Updated:
#Note 1: Ho, Tm, Tb were fabricated values to debug imputeREE. They must be excluded
#Note 2: Samples with less than 3 or less elements to model,
#consider filtering that data, or including more elements do not produce a model
#Note 3: Gd, Er, Y cannot be missing values at the same time. Equidistance condition.
##
#install.packages("magrittr")
#install.packages("devtools")
#install.packages("beepr")
library(magrittr)
library(imputeREE)
library(beepr)
library(dplyr)
sourceDir = 'E:/Feb-March_2024_zircon imaging/05_zircon geochemical data/processed_files'
destDir = sourceDir
#\\ also allowed
file1 = 'imputation_input.csv'
file2 = 'imputation_output_Chondrite Lattice.csv'
filepath1 = file.path(sourceDir, file1)
filepath2 = file.path(destDir, file2)
input_table <- read.csv(filepath1)
head(input_table, n=10)
columnNames = colnames(input_table)
columnNames2 = columnNames[4:length(columnNames)]
#medicine 1
input_table["Ho"][input_table["Ho"] == 0.1] <- NaN
input_table["Tm"][input_table["Tm"] == 0.1] <- NaN
input_table["Tb"][input_table["Tb"] == 0.1] <- NaN
output_table <- input_table %>%
#dplyr::slice(1:100) %>%
model_REE(prefix = NULL, suffix = NULL,
method = 1,
exclude = c("La", "Pr", "Ce", "Eu", "Y", "Ho", "Tm", "Tb"),
chondrite = PalmeOneill2014CI, #Oneill2014Mantle, McDonough1995CI
Calibrate = T) %>%
impute_REE(prefix = NULL, suffix = NULL, rsquared = 0.95)
#model_REE
#method=1 for Chondrite Lattice, 2 for Zhong et al. (2019), or 3 for Chondrite-Onuma method.
#Calibrate= If True, the model is calibrated using the correction factors
#exclude= La, Ce and Eu are the default elements omitted from modelling (not prediction).
#impute_REE
#r-squared = Tolerance to misfitting models. set as 0.9 by default.
#The Chondrite-Lattice method should consider R-squared > 0.95 for at least 3 points.
#The Chondrite-Onuma method should consider R-squared >0.98 for at least 4 points.
head(output_table, n=10)
output_table2 <- output_table
##optional: medicine 2 (redundant and fake elements removed)
#columnNames3 <- append(columnNames2, c("Imputed_Tb","Imputed_Ho",	"Imputed_Tm"))
#output_table2 <- output_table %>% select(-one_of(columnNames3))
write.table(output_table2, file = filepath2, sep = ",", col.names=TRUE, row.names = FALSE)
#col.names = NA to avoid empty rowid
beep()
